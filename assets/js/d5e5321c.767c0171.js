"use strict";(globalThis.webpackChunkmicroservices_docs=globalThis.webpackChunkmicroservices_docs||[]).push([[491],{7013:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"catalog/message_service/data_model","title":"Data Model","description":"Message Service uses MongoDB as its primary database engine and stores the following collections:","source":"@site/docs/catalog/message_service/data_model.md","sourceDirName":"catalog/message_service","slug":"/catalog/message_service/data_model","permalink":"/docs/catalog/message_service/data_model","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"backend","permalink":"/docs/tags/backend"},{"inline":true,"label":"ruby","permalink":"/docs/tags/ruby"},{"inline":true,"label":"opensearch","permalink":"/docs/tags/opensearch"},{"inline":true,"label":"sidekiq","permalink":"/docs/tags/sidekiq"},{"inline":true,"label":"kafka","permalink":"/docs/tags/kafka"},{"inline":true,"label":"mongo","permalink":"/docs/tags/mongo"}],"version":"current","sidebarPosition":30,"frontMatter":{"sidebar_position":30,"title":"Data Model","authors":["Mattia Orfano"],"tags":["backend","ruby","opensearch","sidekiq","kafka","mongo"]},"sidebar":"tutorialSidebar","previous":{"title":"Architecture","permalink":"/docs/catalog/message_service/architecture"},"next":{"title":"API & Authorization","permalink":"/docs/catalog/message_service/api"}}');var l=n(4848),r=n(8453);const c={sidebar_position:30,title:"Data Model",authors:["Mattia Orfano"],tags:["backend","ruby","opensearch","sidekiq","kafka","mongo"]},d=void 0,t={},o=[{value:"Collections",id:"collections",level:2},{value:"Messages",id:"messages",level:3},{value:"Collezione AiMessages",id:"collezione-aimessages",level:3},{value:"Collezione Threads",id:"collezione-threads",level:3},{value:"Collezione Tickets",id:"collezione-tickets",level:3},{value:"Collezione Origins",id:"collezione-origins",level:3},{value:"Collezione Queues",id:"collezione-queues",level:3},{value:"Documenti Incorporati",id:"documenti-incorporati",level:3},{value:"QueueCounter",id:"queuecounter",level:4},{value:"TicketStateTransition",id:"ticketstatetransition",level:4},{value:"Panoramica delle Relazioni",id:"panoramica-delle-relazioni",level:2},{value:"Indicizzazione e Ricerca",id:"indicizzazione-e-ricerca",level:2},{value:"Flusso dei Dati",id:"flusso-dei-dati",level:2}];function a(e){const i={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.p,{children:"Message Service uses MongoDB as its primary database engine and stores the following collections:"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Messages"}),": Represents individual communications between customers and agents (AiMessage and AiSuggestion are subtypes)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Threads"}),": Represents messages tied to a conversation with a customer"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Tickets"}),": Represents support cases with customers"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Origins"}),": Represents communication channels (social media, messaging platforms, etc)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Queues"}),": Used to group tickets together when they meet certain criteria"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"In addition, there are embedded documents:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"QueueCounters"}),": Embedded in Queue, to track the number of tickets by state"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"TicketStateTransitions"}),": Embedded in Tickets, to track state changes and events"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"collections",children:"Collections"}),"\n",(0,l.jsx)(i.h3,{id:"messages",children:"Messages"}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Fields:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (MongoDB identifier)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"author"}),": String (identifier of the author from social media platforms)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"author_name"}),": String (name of the author)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"body"}),": String (message content)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"external_id"}),": String (identifier of the message from social media platforms)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"reply_to"}),": String (external_if of the message being replied to)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"reply_kind"}),": StringifiedSymbol (type of reply: retweet, quote, reply, responder, bump)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"attachments"}),": Array (list of attachments)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"received_at"}),": DateTime (when message was received)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"note"}),": Boolean (whether its a private note)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"extra"}),": Hash (additional custom properties)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"shadowed"}),": Boolean (whether the message was hidden from Chorally agents because Origin has been disabled)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"hidden"}),": Boolean (whether the message was hidden from social media)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"deleted"}),": Boolean (whether the message was deleted from social media)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_operator_reply"}),": Boolean (whether the message is an agent reply)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_escalation"}),": Boolean (whether is an escalation)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_external_reply"}),": Boolean (whether comes from external API)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"template_id"}),": String (templates used for message content)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"origin_id"}),": String (identifier of the Origin)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"created_at"}),": DateTime (when document was created)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"updated_at"}),": DateTime (when document was updated)"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Relazioni:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Appartiene a un Thread (opzionale)"}),"\n",(0,l.jsx)(i.li,{children:"Appartiene a un Ticket"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Indici:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"ticket_id"}),": Per interrogazioni efficienti dei messaggi per ticket"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"shadowed"}),": Per filtrare i messaggi nascosti"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"hidden"}),": Per filtrare i messaggi nascosti"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"deleted"}),": Per filtrare i messaggi eliminati"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_operator_reply"}),": Per filtrare le risposte degli operatori"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_external_reply"}),": Per filtrare le risposte esterne"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_escalation"}),": Per filtrare i messaggi di escalation"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Ricerca:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Utilizza Searchkick per la ricerca full-text e l'indicizzazione"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"collezione-aimessages",children:"Collezione AiMessages"}),"\n",(0,l.jsx)(i.p,{children:"Sottoclasse di Messages che rappresenta contenuti generati dall'IA."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi Aggiuntivi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Eredita tutti i campi da Messages"}),"\n",(0,l.jsx)(i.li,{children:"Pu\xf2 contenere campi specifici per l'IA"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Relazioni:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Stesse di Messages"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"collezione-threads",children:"Collezione Threads"}),"\n",(0,l.jsx)(i.p,{children:"Raggruppa messaggi correlati in una conversazione."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (identificatore documento MongoDB)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"external_id"}),": String (identificatore dal sistema esterno)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"body"}),": String (contenuto del thread)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"attachment_urls"}),": Array (lista di URL degli allegati)"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Relazioni:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Appartiene a una Origin"}),"\n",(0,l.jsx)(i.li,{children:"Ha molti Messages"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Indici:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"external_id"})," e ",(0,l.jsx)(i.code,{children:"origin_id"}),": Indice unico per l'identificazione del thread"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"collezione-tickets",children:"Collezione Tickets"}),"\n",(0,l.jsx)(i.p,{children:"Rappresenta i casi di supporto clienti contenenti messaggi."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (identificatore documento MongoDB)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"group"}),": String (gruppo assegnato al ticket)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"owner"}),": String (proprietario del ticket)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"owner_name"}),": String (nome del proprietario)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"title"}),": String (titolo del ticket)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"received_at"}),": DateTime (quando il ticket \xe8 stato ricevuto)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"sentiment"}),": StringifiedSymbol (sentimento del ticket: negative, neutral, positive, not_assigned)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"sequence"}),": Integer (numero sequenziale del ticket)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"outbound"}),": Boolean (indica se il ticket \xe8 stato creato per un messaggio in uscita)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"is_conversation"}),": Boolean (indica se il ticket \xe8 una conversazione)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"followed_up_to"}),": DateTime (data fino a cui il ticket \xe8 stato seguito)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"author"}),": String (autore denormalizzato)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"last_message_received_at"}),": DateTime (quando \xe8 stato ricevuto l'ultimo messaggio)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"last_customer_received_at"}),": DateTime (quando \xe8 stato ricevuto l'ultimo messaggio del cliente)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"count_visible_messages"}),": Integer (conteggio dei messaggi visibili)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"state"}),": String (stato del ticket: created, replied, closed, followedup, solved, pending, working)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"closed_at"}),": DateTime (quando il ticket \xe8 stato chiuso)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"created_at"}),": DateTime (quando il documento \xe8 stato creato)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"updated_at"}),": DateTime (quando il documento \xe8 stato aggiornato l'ultima volta)"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Relazioni:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Appartiene a una Origin"}),"\n",(0,l.jsx)(i.li,{children:"Ha molti Messages"}),"\n",(0,l.jsx)(i.li,{children:"Ha molti AiSuggestions"}),"\n",(0,l.jsx)(i.li,{children:"Ha molti AiMessages"}),"\n",(0,l.jsx)(i.li,{children:"Ha e appartiene a molte Queues"}),"\n",(0,l.jsx)(i.li,{children:"Incorpora molti TicketStateTransitions"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Indici:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"created_at"}),": Per ordinare per data di creazione"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"updated_at"}),": Per ordinare per data di aggiornamento"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"outbound"}),": Per filtrare i ticket in uscita"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"last_message_received_at"}),": Per ordinare per data dell'ultimo messaggio"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Macchina a Stati:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Implementa una macchina a stati per gli stati dei ticket"}),"\n",(0,l.jsx)(i.li,{children:"Stati: created, replied, closed, followedup, solved, pending, working"}),"\n",(0,l.jsx)(i.li,{children:"Le transizioni tra stati sono gestite dal concern TicketStateMachine"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"collezione-origins",children:"Collezione Origins"}),"\n",(0,l.jsx)(i.p,{children:"Rappresenta i canali di comunicazione da cui provengono i messaggi."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (identificatore documento MongoDB)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"name"}),": String (nome dell'origine)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"external_id"}),": String (identificatore dal sistema esterno)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"owner"}),": String (proprietario dell'origine)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"kind"}),": StringifiedSymbol (tipo di origine: facebook_public, instagram_comment, x_mention, ecc.)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"channel"}),": StringifiedSymbol (canale: facebook, instagram, whatsapp, x, ecc.)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"active"}),": Boolean (indica se l'origine \xe8 attiva)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"public"}),": Boolean (indica se l'origine \xe8 pubblica)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"outbound"}),": Boolean (indica se l'origine supporta messaggi in uscita)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"capabilities"}),": Hash (capacit\xe0 dell'origine)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"description"}),": String (descrizione dell'origine)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"locking_name"}),": String (nome per il blocco)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"locked_at"}),": Time (quando l'origine \xe8 stata bloccata)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"close_after_solve"}),": Integer (ore dopo le quali chiudere i ticket risolti)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"close_after_wait"}),": Integer (ore dopo le quali chiudere i ticket in attesa)"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Relazioni:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Ha molti Threads"}),"\n",(0,l.jsx)(i.li,{children:"Ha molti Tickets"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Indici:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"external_id"}),", ",(0,l.jsx)(i.code,{children:"owner"}),", e ",(0,l.jsx)(i.code,{children:"kind"}),": Indice unico per l'identificazione dell'origine"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"collezione-queues",children:"Collezione Queues"}),"\n",(0,l.jsx)(i.p,{children:"Organizza i ticket in base a regole specifiche."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (identificatore documento MongoDB)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"name"}),": String (nome della coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"description"}),": String (descrizione della coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"owner"}),": String (proprietario della coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"order"}),": Integer (ordine di visualizzazione)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"groups"}),": Array (gruppi associati alla coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"users"}),": Array (utenti associati alla coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"status"}),": Boolean (stato della coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"rules"}),": Array (regole per la coda)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"rule"}),": String (ID della regola dal rule-engine)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"created_at"}),": DateTime (quando il documento \xe8 stato creato)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"updated_at"}),": DateTime (quando il documento \xe8 stato aggiornato l'ultima volta)"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Relazioni:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Ha e appartiene a molti Tickets"}),"\n",(0,l.jsx)(i.li,{children:"Incorpora molti QueueCounters"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Documenti Incorporati:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"QueueCounters: Traccia il numero di ticket in ogni stato"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"documenti-incorporati",children:"Documenti Incorporati"}),"\n",(0,l.jsx)(i.h4,{id:"queuecounter",children:"QueueCounter"}),"\n",(0,l.jsx)(i.p,{children:"Incorporato nelle Queues per tracciare il conteggio dei ticket per stato."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (identificatore documento MongoDB)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"name"}),": String (nome del contatore)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"states"}),": Array (stati da contare)"]}),"\n"]}),"\n",(0,l.jsx)(i.h4,{id:"ticketstatetransition",children:"TicketStateTransition"}),"\n",(0,l.jsx)(i.p,{children:"Incorporato nei Tickets per tracciare i cambiamenti di stato."}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Campi:"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"_id"}),": ObjectId (identificatore documento MongoDB)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"namespace"}),": String (namespace dell'evento)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"event"}),": String (evento che ha causato la transizione)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"from"}),": String (stato prima della transizione)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"to"}),": String (stato dopo la transizione)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"created_at"}),": DateTime (quando \xe8 avvenuta la transizione)"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"panoramica-delle-relazioni",children:"Panoramica delle Relazioni"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Origin \u2192 Ticket \u2192 Message"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Una Origin ha molti Tickets"}),"\n",(0,l.jsx)(i.li,{children:"Un Ticket ha molti Messages"}),"\n",(0,l.jsx)(i.li,{children:"Un Message appartiene a un Ticket"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Origin \u2192 Thread \u2192 Message"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Una Origin ha molti Threads"}),"\n",(0,l.jsx)(i.li,{children:"Un Thread ha molti Messages"}),"\n",(0,l.jsx)(i.li,{children:"Un Message pu\xf2 appartenere a un Thread (opzionale)"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Ticket \u2194 Queue"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Un Ticket pu\xf2 appartenere a molte Queues"}),"\n",(0,l.jsx)(i.li,{children:"Una Queue pu\xf2 contenere molti Tickets"}),"\n",(0,l.jsx)(i.li,{children:"Una Queue incorpora molti QueueCounters per tracciare i conteggi"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Ticket \u2192 TicketStateTransition"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Un Ticket incorpora molti TicketStateTransitions che registrano i cambiamenti di stato"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"indicizzazione-e-ricerca",children:"Indicizzazione e Ricerca"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"I Messages sono indicizzati utilizzando Searchkick per la ricerca full-text"}),"\n",(0,l.jsx)(i.li,{children:"Vari indici sono definiti sulle collezioni per interrogazioni efficienti"}),"\n",(0,l.jsx)(i.li,{children:"I dati di ricerca per i messaggi includono informazioni denormalizzate dai ticket e dalle origini correlate"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"flusso-dei-dati",children:"Flusso dei Dati"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Ricezione del Messaggio"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Un messaggio viene ricevuto da un'origine (es. Facebook, Instagram)"}),"\n",(0,l.jsx)(i.li,{children:"Il sistema crea o trova il thread associato"}),"\n",(0,l.jsx)(i.li,{children:"Il sistema crea o trova il ticket associato"}),"\n",(0,l.jsx)(i.li,{children:"Il messaggio viene salvato e associato al ticket e al thread"}),"\n",(0,l.jsx)(i.li,{children:"Lo stato del ticket cambia in base al tipo di messaggio"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Invio del Messaggio"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Un operatore crea un messaggio di risposta"}),"\n",(0,l.jsx)(i.li,{children:"Il messaggio viene associato al ticket esistente"}),"\n",(0,l.jsx)(i.li,{children:"Il messaggio viene inviato all'origine appropriata"}),"\n",(0,l.jsx)(i.li,{children:"Lo stato del ticket cambia in base al tipo di messaggio"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Gestione dei Ticket"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"I ticket vengono organizzati in code in base a regole"}),"\n",(0,l.jsx)(i.li,{children:"Gli operatori possono cambiare gli stati dei ticket"}),"\n",(0,l.jsx)(i.li,{children:"I ticket possono essere chiusi automaticamente dopo un periodo di inattivit\xe0"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>c,x:()=>d});var s=n(6540);const l={},r=s.createContext(l);function c(e){const i=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),s.createElement(r.Provider,{value:i},e.children)}}}]);